function u = quadtraj(refx,refy,x,y,psi,t)
[ref,Bconv]=refgen([refx;refy],t,t+12*0.1,0.1);
C=zeros(2,3);
C(1,1)=1;
C(2,2)=1;
A=eye(3);
Aconv=[C*A;C*A^2;C*A^3;C*A^4;C*A^5;C*A^6;C*A^7;C*A^8;C*A^9;C*A^10;C*A^11;C*A^12];
Q=eye(24);
R=0.1*eye(24);
H=Bconv'*Q*Bconv;
E=(Q*Bconv)*(Aconv*[x;y;psi]-ref);
U=quadprog(H+R,E,[],[],[],[],[-150;-150;-150;-150;-150;-150;-150;-150;-150;-150;-150;-150;-150;-150;-150;-150;-150;-150;-150;-150;-150;-150;-150;-150],[150;150;150;150;150;150;150;150;150;150;150;150;150;150;150;150;150;150;150;150;150;150;150;150]);
u=U(1:2);